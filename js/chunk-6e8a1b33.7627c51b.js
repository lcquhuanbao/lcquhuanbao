(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e8a1b33"],{3969:function(t,s,o){"use strict";var i=o("b4cd"),e=o.n(i);e.a},9878:function(t,s,o){"use strict";o.r(s);var i,e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{ref:"content",staticClass:"details_shop_conn",on:{scroll:t.scroll}},[i("div",{staticClass:"step-jump"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showNav,expression:"showNav"}],staticClass:"fx details_head"},[i("div",[i("img",{staticClass:"op_img",attrs:{src:o("2db1"),alt:""},on:{click:t.toBack}})]),i("div",[i("img",{staticClass:"op_img",attrs:{src:o("4e31"),alt:""},on:{click:t.addEwm}})])]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.showNav,expression:"!showNav"}],staticClass:"fx details_head",style:t.opacityStyle},[i("div",[i("img",{attrs:{src:o("a68c"),alt:""},on:{click:t.toBack}})]),i("div",{staticClass:"details_head_a fx"},t._l(t.lis,function(s,o){return i("a",{key:o,class:{active:o==t.activeStep},on:{click:function(s){return s.preventDefault(),t.jump(o)}}},[t._v(t._s(s))])}),0),i("div",[i("img",{attrs:{src:o("32cf"),alt:""},on:{click:t.addEwm}})])])]),i("shop-details-swiper",{directives:[{name:"show",rawName:"v-show",value:t.shopInfo.img_json.length>0,expression:"shopInfo.img_json.length>0"}],attrs:{list:t.shopInfo.img_json,id:"shophead"},on:{setXq:t.setXq}}),i("shop-details-title",{attrs:{shopInfo:t.shopInfo}}),t.shopInfo.shopInfo&&t.shopInfo.coupon.length>0||t.shopInfo.discount_number>0||t.shopInfo.send_score>0?i("div",{staticClass:"details_liubai s1"}):t._e(),i("shop-details-cell",{attrs:{shopInfo:t.shopInfo}}),t.shopInfo.one_talk?i("div",{staticClass:"details_liubai step-jump"}):t._e(),t.shopInfo.one_talk?i("shop-details-sevaluate",{attrs:{oneTalk:t.shopInfo.one_talk,talk_num:t.shopInfo.talk_num}}):t._e(),t.shopInfo.sid>0||t.shopInfo.recommend.length>0||t.shopInfo.hot.length>0?i("div",{staticClass:"details_liubai"}):t._e(),i("shopDetailsShop",{attrs:{shopInfo:t.shopInfo}}),i("div",{staticClass:"details_liubai"}),t.shopInfo.content?i("shopDetailsInfo",{staticClass:"step-jump",attrs:{content:t.shopInfo.content,id:"shopinfo"}}):t._e(),i("van-goods-action",[t.shopInfo.sid>0?i("van-goods-action-icon",{attrs:{icon:"shop-o",text:"店铺"},on:{click:t.toSupplierShop}}):i("van-goods-action-icon",{attrs:{icon:"home-o",text:"首页"},on:{click:function(s){return t.$router.push("/index")}}}),t.shopInfo.kf_im?i("van-goods-action-icon",{attrs:{icon:"chat-o",text:"客服"},on:{click:t.toIm}}):i("van-goods-action-icon",{attrs:{icon:"chat-o",text:"会员"},on:{click:function(s){return t.$router.push("/member/member")}}}),i("van-goods-action-icon",{attrs:{icon:"cart-o",info:t.shopInfo.cart_number||"",text:"购物车"},on:{click:function(s){return t.$router.push("/shop/shopcard")}}}),0==t.shopInfo.types||1==t.shopInfo.types?i("van-goods-action-button",{attrs:{type:"warning",text:"加入购物车"},on:{click:function(s){return t.addCard(0)}}}):t._e(),0==t.shopInfo.types||1==t.shopInfo.types?i("van-goods-action-button",{attrs:{type:"danger",text:"立即购买"},on:{click:function(s){return t.addCard(1)}}}):t._e(),6==t.shopInfo.types?i("van-goods-action-button",{attrs:{type:"warning",text:"电话咨询"},on:{click:t.sendTel}}):t._e(),6==t.shopInfo.types?i("van-goods-action-button",{attrs:{type:"danger",text:"立即预约"},on:{click:function(s){return t.addCard(1)}}}):t._e()],1),i("div",{staticStyle:{height:"50px"}}),i("van-popup",{staticStyle:{"border-radius":"5px 5px 0 0"},attrs:{position:"bottom",overlay:!0},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[i("shopDetailsSku",{attrs:{shopInfo:t.shopInfo,toAut:t.index},on:{closePop:t.getClosePop}})],1),i("van-popup",{staticClass:"animated show-share-pop",class:[t.showShare?"bounceInDown":"bounceOutUp"],attrs:{position:""},model:{value:t.showShare,callback:function(s){t.showShare=s},expression:"showShare"}},[i("div",[i("div",{staticClass:"upload_shaer_img"},[i("img",{staticClass:"imgUrl",attrs:{src:t.imgUrl,alt:""}}),i("van-icon",{attrs:{name:"clear",size:"28px",color:"red"},on:{click:function(s){t.showShare=!1}}})],1),i("div",{staticClass:"upload_shaer_btn"},[i("div",{staticClass:"tc",on:{click:function(s){return t.uploadShare(t.isWx)}}},[i("img",{staticClass:"upload_img_ewm",attrs:{src:o("8b80"),alt:""}}),i("span",[t._v(t._s(0==t.isWx?"长按保存":"保存到系统相册"))])])])])]),i("div",{ref:"imageDom",staticClass:"shop-share"},[i("div",{staticClass:"shop-share-con"},[i("div",{staticClass:"shop-share-head"},[i("img",{attrs:{src:t.$fnc.getImgUrl(t.shopInfo.piclink),crossorigin:"anonymous",alt:""}})]),i("p",{staticClass:"shop-share-title"},[t._v("\n                "+t._s(t.shopInfo.title)+"\n                "),i("span",[i("small",[t._v("￥")]),t._v("\n                    "+t._s(t.shopInfo.price)+"\n                ")])]),i("p",{staticClass:"shop-share-tj"},[t._v("推荐理由："+t._s(t.shopInfo.sub_title))])]),i("img",{attrs:{src:o("9def8"),crossorigin:"anonymous",alt:""}}),i("div",{staticClass:"shop-share-footer fx"},[i("div",{staticClass:"fx"},[i("img",{attrs:{src:t.$fnc.getImgUrl(t.$store.state.user.avatar,"sex")||(2==t.$store.state.user.sex?o("d750"):o("15e3")),crossorigin:"anonymous",alt:""}}),i("div",[i("span",[t._v(t._s((t.$store.state.user.nickname+"").length>=12?(t.$store.state.user.nickname+"").slice(0,12):t.$store.state.user.nickname||t.$store.state.user.username))]),i("p",[t._v("为你推荐")])])]),i("div",{attrs:{id:"qrcode"}})])])],1)},a=[],n=o("9523"),r=o.n(n),h=(o("ef6f"),o("82a8")),c=(o("591c"),o("7713")),p=(o("93ac"),o("bb33")),l=o("f63a"),u=o("1fb4"),d=o("b708"),f=o("5939"),m=o("e5eb"),g=o("ac0e"),v=o("608a"),_=o("fdb1"),I=o("c0e9"),$=o.n(I),y=o("d044"),w=o.n(y),S=o("a78e"),k=o.n(S),b=(o("5118"),{name:"productdetails",components:(i={shopDetailsSwiper:l["a"],shopDetailsTitle:u["a"]},r()(i,"shopDetailsTitle",u["a"]),r()(i,"shopDetailsCell",d["a"]),r()(i,"shopDetailsSevaluate",f["a"]),r()(i,"shopDetailsShop",m["a"]),r()(i,"shopDetailsInfo",g["a"]),r()(i,p["a"].name,p["a"]),r()(i,c["a"].name,c["a"]),r()(i,h["a"].name,h["a"]),r()(i,"shopDetailsSku",v["a"]),r()(i,"ShopShare",_["a"]),i),data:function(){return{shopInfo:{img_json:[],one_talk:{},recommend:[],hot:[]},lis:[],activeStep:-1,index:0,show:!1,showNav:!0,opacityStyle:{opacity:0,background:""},scrollTop:0,pageTop:0,showShare:!1,url:location.origin,imgUrl:"",isWx:"0",timer:null}},watch:{$route:function(t,s){"shopdetails"!=t.name&&sessionStorage.setItem("tid",this.$route.query.tid)}},beforeDestroy:function(){this.timer&&close(this.timer),sessionStorage.setItem("tid",this.$route.query.tid)},beforeCreate:function(){},created:function(){var t=this;this.getShopDetails(this.$route.query.id),this.appusers.uid!=this.$route.query.tid&&this.$router.push(this.$route.path+"?tid="+this.appusers.uid+"&id="+this.$route.query.id+"&tshare="+this.$route.query.tid),close(this.timer),this.$nextTick(function(){t.pageTop=t.scrollTop});var s=window.navigator.userAgent.toLowerCase(),o=!!k.a.get("user");"micromessenger"==s.match(/MicroMessenger/i)?(this.isWx="0",o&&1==this.$store.state.config.plugin.zyfh.is_open&&this.starTimer()):"ykapp"==s.match(/ykapp/i)?(o&&1==this.$store.state.config.plugin.zyfh.is_open&&this.starTimer(),this.isWx="1"):(o&&1==this.$store.state.config.plugin.zyfh.is_open&&this.starTimer(),this.isWx="2")},mounted:function(){},methods:{starTimer:function(){var t=this,s=this.$route.query.tshare||this.appusers.uid;0!=s&&s!=this.$route.query.tid&&"undefined"!=s&&(this.timer=setInterval(function(){t.endTp()},1e4))},toIm:function(){var t=this.$route.query.tshare||this.appusers.uid;this.getTp({pid:this.$route.query.id,sid:this.shopInfo.sid,is_im:1,tid:t}),this.$router.push(this.shopInfo.kf_im)},toSupplierShop:function(){var t=this.$route.query.tshare||this.appusers.uid;this.getTp({pid:this.$route.query.id,sid:this.shopInfo.sid,is_store:1,tid:t}),this.$router.push("/supplier/supplierdetails?id="+this.shopInfo.sid)},endTp:function(t){var s=!k.a.get("user");if(!s||0!=this.$store.state.config.plugin.zyfh.is_open){t=t||this.$route.query.id||"";var o=sessionStorage.getItem("tid")||"";if(""!=t&&""!=o){var i=this.shopInfo.sid||"";this.$api.getZhanYe.endShopTp({pid:t,sid:i})}}},getTp:function(t){var s=t.pid,o=t.sid,i=(t.tid,t.is_ask),e=t.is_msg,a=t.is_im,n=t.is_store,r=!k.a.get("user"),h=sessionStorage.getItem("tid")||0;if(0!=h&&h!=this.$store.state.user.uid&&"undefined"!=h&&(!r||1!=this.$store.state.config.plugin.zyfh.is_open)){var c={};c.pid=s||this.$route.query.id||"",c.sid=o||"0",c.tid=h,c.is_ask=i||"0",c.is_msg=e||"0",c.is_im=a||"0",c.is_store=n||"0",this.$api.getZhanYe.addShopTp(c)}},sendTel:function(){var t=this.$store.state.config.shop.mall_tel||"";if(""==t)return this.$toast.fail("商铺电话为空，请联系客服"),!1;this.$fnc.tel(t)},addEwm:function(){var t=!k.a.get("user");t?this.$toast.fail("请先登录！"):this.showPop()},addCard:function(t){var s=this,o=!k.a.get("user");if(o)return this.$toast.fail("请先登录！"),setTimeout(function(){s.$store.dispatch("getUser")},1e3),!1;var i=this.$store.state.config.shop.reg_permission||0,e=this.$store.state.user;return 0==e.tid&&1==i?(this.$store.commit("setTsShare",!0),!1):""==e.tel?(this.$store.commit("setShowBingPhone",!0),!1):(0==t?this.shopInfo.types>0?this.index=1:this.index=0:this.index=1,void(this.show=!0))},setXq:function(){this.jump(2)},jump:function(t){var s=this;this.activeStep=t;var o=document.querySelectorAll(".step-jump"),i=o[t].offsetTop+45,e=this.pageTop,a=i/50>>0;if(i>e)r();else{var n=e-i;a=n/50>>0,h()}function r(){e<i?(e+=a,s.onScroll1(e),setTimeout(r,10)):s.onScroll1(i)}function h(){e>i?(e-=a,s.onScroll1(e),setTimeout(h,10)):s.onScroll1(i)}},onScroll1:function(t){this.$refs.content.scrollTop=t-45},onScroll:function(){var t=this,s=document.querySelectorAll(".step-jump");s.forEach(function(s,o){t.scrollTop>=s.offsetTop&&(t.activeStep=o)})},scroll:function(t){var s=t.srcElement.scrollTop;if(s>60){var o=s/140;o=o>1?1:o;this.opacityStyle.opacity=o,this.opacityStyle.background="rgba(255,68,68,"+o+")",this.showNav=!1}else this.showNav=!0;this.scrollTop=s,this.onScroll(),this.pageTop=s},getClosePop:function(){this.show=!1},getShopDetails:function(t){var s=this,o={};o.id=t||"",this.$api.getShop.getShopDetails(o).then(function(t){if(200==t.code){s.shopInfo=t.result,s.qrcode();var o=!!k.a.get("user");o&&1==s.$store.state.config.plugin.zyfh.is_open&&s.getTp({pid:s.shopInfo.id,sid:s.shopInfo.sid});var i=["商品"];t.result.one_talk&&i.push("评论"),t.result.content&&i.push("详情"),s.lis=i}})},qrcode:function(){new w.a("qrcode",{width:56,height:56,text:this.url+this.$route.path+"?id="+this.$route.query.id+"&tid="+(this.$store.state.user.uid||"0"),colorDark:"#000",colorLight:"#fff"})},showPop:function(){var t=this,s=this.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"加载中..."});$()(this.$refs.imageDom,{useCORS:!0,logging:!0}).then(function(o){t.imgUrl=o.toDataURL("image/png"),t.imgUrl&&(t.showShare=!0,s.clear())})},uploadShare:function(t){this.show=!1,this.$fnc.ykAppUpImage(this.imgUrl)}}}),x=b,C=(o("3969"),o("2877")),T=Object(C["a"])(x,e,a,!1,null,"31626cf8",null);s["default"]=T.exports},b4cd:function(t,s,o){}}]);