(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7580a058"],{"38e8":function(a,t,e){"use strict";e.r(t);var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"con_bg"},[e("van-nav-bar",{staticClass:"navbar",attrs:{title:"关联微信支付宝","left-text":"","left-arrow":""},on:{"click-left":a.toBack}}),e("form",[e("div",{staticClass:"cu-form-group margin-top"},[e("div",{staticClass:"title hongx sx"},[a._v("支付宝姓名")]),e("van-cell-group",{attrs:{border:!1}},[e("van-field",{attrs:{type:"text",placeholder:"请使用真实姓名",clearable:""},on:{blur:a.windowScorll},model:{value:a.userInfoData.alipay_name,callback:function(t){a.$set(a.userInfoData,"alipay_name",t)},expression:"userInfoData.alipay_name"}})],1)],1),e("div",{staticClass:"cu-form-group"},[e("div",{staticClass:"title sx hongx"},[a._v("支付宝账号")]),e("van-cell-group",{attrs:{border:!1}},[e("van-field",{attrs:{type:"text",placeholder:"请填写正确的支付宝账号(将加密保存)",clearable:""},on:{blur:a.windowScorll},model:{value:a.userInfoData.alipay,callback:function(t){a.$set(a.userInfoData,"alipay",t)},expression:"userInfoData.alipay"}})],1)],1),a._m(0),a._m(1),e("div",{staticClass:"bg-gradual-write up_img_con"},[e("div",{staticClass:"box_alea"},[e("div",{directives:[{name:"show",rawName:"v-show",value:a.alipyImgList,expression:"alipyImgList"}],staticClass:"up_bor",style:"background-image:url("+a.$fnc.getImgUrl(a.alipyImgList)+")",on:{click:function(t){return a.imagePreview(a.alipyImgList)}}}),e("div",{directives:[{name:"show",rawName:"v-show",value:a.alipyImgList,expression:"alipyImgList"}],staticClass:"cu-tag close_img bg-red"},[e("van-icon",{attrs:{name:"cross",color:"#fff",size:"14"},on:{click:function(t){return a.closeImg("支付宝")}}})],1),e("van-uploader",{attrs:{"after-read":a.onReadA}},[e("div",{directives:[{name:"show",rawName:"v-show",value:""==a.alipyImgList,expression:"alipyImgList==''"}],staticClass:"up_bor"},[e("div",{staticClass:"wx_up_img wx_up_img_zfb"}),e("div",{staticClass:"up_text"},[a._v("上传支付宝收款码")])])])],1)]),0==a.userInfo.is_real?e("div",{staticClass:"padding"},[e("div",{staticClass:"cu-btn but bg-gradual-orange block margin-tb-sm lg",on:{click:a.subInfo}},[a._v("确定")])]):a._e()])],1)},s=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"cu-form-group mar_top"},[e("div",{staticClass:"title hongx"},[a._v("\n        上传支付宝收款码截图\n        "),e("span",{staticStyle:{color:"#999"}})])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"cu-form-group",staticStyle:{border:"none"}},[e("div",{staticClass:"title beiz"},[e("div",{staticStyle:{color:"#999"}},[a._v("温馨提示：请上传支付宝收款二维码的截图，请勿裁剪涂改，保证图片信息清晰显示，否则无法审核通过")])])])}],n=(e("4662"),e("28a2")),o=e("9523"),r=e.n(o),l=(e("be7f"),e("565f")),c=e("bc3a"),u=e.n(c),p={name:"alpaywx",data:function(){return{avatar:"",wximgList:"",alipyImgList:"",userInfoData:{alipay_name:"",alipay:"",wechat:""},loadModal:!1,iswx:!0,src:"",userInfo:this.$store.state.user}},components:r()({},l["a"].name,l["a"]),computed:{},methods:{imagePreview:function(a){Object(n["a"])([this.$fnc.getImgUrl(a)])},closeImg:function(a){var t=this;this.$dialog.confirm({title:"提示",message:"确定删除"+a+"图片吗"}).then(function(){"微信"==a?t.wximgList="":t.alipyImgList=""})},onRead:function(a){this.iswx=!0,this.cpimgOk(a.content)},onReadA:function(a){this.iswx=!1,this.cpimgOk(a.content)},cpimgOk:function(a){this.$toast.loading({mask:!1,message:"上传中...",duration:0});var t=this,e=new Image;e.src=a,e.onload=function(){var a=document.createElement("canvas"),i=a.getContext("2d"),s=e.width,n=e.height,o=750,r=750,l=s,c=n;(s>o||n>r)&&(s/n>o/r?(l=o,c=Math.round(o*(n/s))):(c=r,l=Math.round(r*(s/n)))),a.width=l,a.height=c,i.clearRect(0,0,l,c),i.drawImage(e,0,0,l,c);var p=a.toDataURL("image/jpeg",.92),m=t.convertBase64UrlToBlob(p),d=new FormData;d.append("file",m,"file_"+Date.parse(new Date)+".jpg");var f={headers:{"Content-Type":"multipart/form-data"}};u.a.post("/api/common/upload/index/",d,f).then(function(a){200==a.data.code?(t.avatar=a.data.result,t.iswx?t.wximgList=a.data.result:t.alipyImgList=a.data.result,t.$toast.clear()):t.$toast.fail("图片上传失败")})}},convertBase64UrlToBlob:function(a){for(var t=window.atob(a.split(",")[1]),e=new ArrayBuffer(t.length),i=new Uint8Array(e),s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return new Blob([e],{type:"image/png"})},subInfo:function(){var a=this;if(""==this.userInfoData.alipay_name||this.userInfoData.alipay_name.length>6)return this.$toast.fail("支付宝姓名不能为空，且最多不超过6个字符"),!1;if(""==this.userInfoData.alipay||this.userInfoData.alipay.length>25)return this.$toast.fail("支付宝账号不能为空，且最多不超过25个字符"),!1;var t={alipay_name:this.userInfoData.alipay_name,alipay:this.userInfoData.alipay,alipay_pic:this.alipyImgList||""};this.$api.getSetting.setAlipySetting(t).then(function(t){200==t.code&&(a.$toast.success("操作成功"),setTimeout(function(){a.$store.dispatch("getUser"),a.toBack()},1500))})}},created:function(){var a=this.$store.state.user;this.userInfoData={alipay_name:a.alipay_name,alipay:a.alipay},this.alipyImgList=a.alipay_pic||""}},m=p,d=(e("3a64"),e("2877")),f=Object(d["a"])(m,i,s,!1,null,"4e109ef2",null);t["default"]=f.exports},"3a64":function(a,t,e){"use strict";var i=e("73b2"),s=e.n(i);s.a},4662:function(a,t,e){"use strict";e("68ef"),e("4d75"),e("8270"),e("786d"),e("504b")},"73b2":function(a,t,e){}}]);