(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a6adf70"],{"14e9":function(t,e,n){"use strict";var i=n("494a"),a=n.n(i);a.a},"1f88":function(t,e,n){"use strict";n.r(e);var i,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pay_con"},[n("van-nav-bar",{staticClass:"navbar",attrs:{title:"提交评价","left-text":"","left-arrow":"",border:!1},on:{"click-left":t.toBack}}),n("div",{staticClass:"pay_con_d"},[n("van-card",{staticClass:"review_card",attrs:{desc:t.$fnc.getTimeFormat(t.info.created_time),title:t.info.title,thumb:t.info.piclink}}),n("div",{staticClass:"review_rate"},[n("p",[t._v("选择评价星级")]),n("van-rate",{attrs:{readonly:1==t.info.is_review,size:"38px"},model:{value:t.form.star,callback:function(e){t.$set(t.form,"star",e)},expression:"form.star"}})],1),n("div",{staticClass:"review_msg"},[n("van-cell-group",{attrs:{border:!1}},[n("van-field",{staticClass:"textarcy",attrs:{border:!1,disabled:1==t.info.is_review,type:"textarea",placeholder:"请输入您的评价",autosize:""},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}}),n("div",{staticClass:"fx conm1"},[t._l(t.pic,function(e,i){return n("div",{key:i,staticClass:"box_img_img"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"item"}],attrs:{width:"84",height:"84",src:e}}),n("span",{on:{click:function(e){return t.closeImg(i)}}},[n("van-icon",{attrs:{name:"cross",size:"18",color:"#fff"}})],1)])}),0==t.info.is_review?n("van-uploader",{attrs:{multiple:"","max-count":3,"after-read":t.afterRead}},[n("div",{staticClass:"up_inp_refund"},[n("van-icon",{staticClass:"fa fa-camera",attrs:{name:"close"}}),n("p",[t._v("添加照片")])],1)]):t._e()],2)],1)],1),n("p",{staticClass:"review_p"},[t._v("评价文字/图片共得10积分")]),n("div",{staticClass:"review_btn"},[n("van-button",{attrs:{disabled:1==t.info.is_review,size:"large"},on:{click:t.sunForm}},[t._v(t._s(1==t.info.is_review?"已评价":"提交评价"))])],1),n("coupon",{staticStyle:{width:"72%",margin:"0 auto","background-color":"transparent"},attrs:{show:t.coupon_show,coupon_type:"评价优惠卷",da:t.coupon_list},on:{close_coupon:t.reveive_close}}),n("turn",{attrs:{con:"评价后",show:t.turn_show},on:{send_isturn:t.receive_isturn}})],1)],1)},o=[],s=n("7037"),r=n.n(s),c=n("9523"),l=n.n(c),u=(n("be7f"),n("565f")),p=(n("4142"),n("39d1")),d=(n("9cb7"),n("66fd")),_=n("bc3a"),f=n.n(_),v=n("5118"),m=n("fb94"),h=n("a6f2"),b={components:(i={},l()(i,d["a"].name,d["a"]),l()(i,p["a"].name,p["a"]),l()(i,u["a"].name,u["a"]),l()(i,"coupon",m["a"]),l()(i,"turn",h["a"]),i),data:function(){return{turn_show:!1,is_turn:Boolean,coupon_list:[{money:"",desc:"",xfm:"",end_time:""}],coupon_show:!1,info:{},value:5,message:"",pic:[],form:{content:"",star:5}}},created:function(){this.getInfo()},methods:{receive_isturn:function(t){this.is_turn=t},reveive_close:function(){this.coupon_show=!1,this.toBack()},closeImg:function(t){this.pic.splice(t,1)},sunForm:function(){var t=this,e=this;e.$dialog.confirm({title:"提示",message:"是否提交？"}).then(function(){var n={};n=e.form,n.id=e.$route.query.id||"",n.pic=e.pic.join("@")||"",e.$api.getShop.addReview(n).then(function(n){200==n.code&&(e.$toast.success("评价成功"),Object(v["setTimeout"])(function(){1!=t.is_turn?"object"==r()(n.result)&&(t.coupon_list=n.result,t.coupon_show=!0):t.turn_show=!0},1500))})})},getInfo:function(){var t=this,e={};e.id=this.$route.query.id||"",this.$api.getShop.getInfo(e).then(function(e){200==e.code&&(t.info=e.result,1==e.result.is_review&&(t.form.content=e.result.review.content,t.form=e.result.review,1==e.result.review.is_pic?t.pic=e.result.review.piclink:t.pic=[]))})},afterRead:function(t){this.myUpload(t.content)},myUpload:function(t){var e=this,n=new Image;n.src=t,n.onload=function(){var t=document.createElement("canvas"),i=t.getContext("2d"),a=n.width,o=n.height,s=750,r=750,c=a,l=o;(a>s||o>r)&&(a/o>s/r?(c=s,l=Math.round(s*(o/a))):(l=r,c=Math.round(r*(a/o)))),t.width=c,t.height=l,i.clearRect(0,0,c,l),i.drawImage(n,0,0,c,l);var u=t.toDataURL("image/jpeg",.92),p=e.convertBase64UrlToBlob(u),d=new FormData;d.append("file",p,"file_"+Date.parse(new Date)+".jpg");var _={headers:{"Content-Type":"multipart/form-data"}};f.a.post("/api/common/upload/index/",d,_).then(function(t){return 200==t.data.code?(e.pic.push(t.data.result),!0):(e.$toast.fail("上传失败"),!1)})}},convertBase64UrlToBlob:function(t){for(var e=window.atob(t.split(",")[1]),n=new ArrayBuffer(e.length),i=new Uint8Array(n),a=0;a<e.length;a++)i[a]=e.charCodeAt(a);return new Blob([n],{type:"image/png"})}}},w=b,g=(n("31af"),n("2877")),y=Object(g["a"])(w,a,o,!1,null,"6c5fb8d2",null);e["default"]=y.exports},"31af":function(t,e,n){"use strict";var i=n("3c56"),a=n.n(i);a.a},3260:function(t,e,n){t.exports=n.p+"img/turntable_bottom.4fed1644.png"},"3c56":function(t,e,n){},"494a":function(t,e,n){},"55f6":function(t,e,n){t.exports=n.p+"img/turn_reward2.024c7182.png"},"5a68":function(t,e,n){t.exports=n.p+"img/turn_pointer.3de923aa.png"},"66fd":function(t,e,n){"use strict";var i=n("2638"),a=n.n(i),o=n("d282"),s=n("a142"),r=n("ba31"),c=n("a3e2"),l=n("44bf"),u=Object(o["a"])("card"),p=u[0],d=u[1];function _(t,e,n,i){var o=e.thumb,u=n.num||Object(s["b"])(e.num),p=n.price||Object(s["b"])(e.price),_=n["origin-price"]||Object(s["b"])(e.originPrice),f=u||p||_;function v(t){Object(r["a"])(i,"click-thumb",t)}function m(){if(n.tag||e.tag)return t("div",{class:d("tag")},[n.tag?n.tag():t(c["a"],{attrs:{mark:!0,type:"danger"}},[e.tag])])}function h(){if(n.thumb||o)return t("a",{attrs:{href:e.thumbLink},class:d("thumb"),on:{click:v}},[n.thumb?n.thumb():t(l["a"],{attrs:{src:o,width:"100%",height:"100%",fit:"contain","lazy-load":e.lazyLoad}}),m()])}function b(){return n.title?n.title():e.title?t("div",{class:d("title")},[e.title]):void 0}function w(){return n.desc?n.desc():e.desc?t("div",{class:[d("desc"),"van-ellipsis"]},[e.desc]):void 0}function g(){if(p)return t("div",{class:d("price")},[n.price?n.price():e.currency+" "+e.price])}function y(){if(_){var i=n["origin-price"];return t("div",{class:d("origin-price")},[i?i():e.currency+" "+e.originPrice])}}function C(){if(u)return t("div",{class:d("num")},[n.num?n.num():"x "+e.num])}function k(){if(n.footer)return t("div",{class:d("footer")},[n.footer()])}return t("div",a()([{class:d()},Object(r["b"])(i,!0)]),[t("div",{class:d("header")},[h(),t("div",{class:d("content",{centered:e.centered})},[b(),w(),n.tags&&n.tags(),f&&t("div",{class:"van-card__bottom"},[g(),y(),C(),n.bottom&&n.bottom()])])]),k()])}_.props={tag:String,desc:String,thumb:String,title:String,centered:Boolean,lazyLoad:Boolean,thumbLink:String,num:[Number,String],price:[Number,String],originPrice:[Number,String],currency:{type:String,default:"¥"}},e["a"]=p(_)},"6ff8":function(t,e,n){t.exports=n.p+"img/turntable_bj.545e0731.png"},97685:function(t,e,n){},"9b7e":function(t,e,n){},"9cb7":function(t,e,n){"use strict";n("68ef"),n("9b7e"),n("09fe"),n("ea82")},a3e2:function(t,e,n){"use strict";var i=n("2638"),a=n.n(i),o=n("d282"),s=n("ba31"),r=Object(o["a"])("tag"),c=r[0],l=r[1];function u(t,e,n,i){var o,r=e.type,c=e.mark,u=e.plain,p=e.color,d=e.round,_=e.size,f=u?"color":"backgroundColor",v=(o={},o[f]=p,o);e.textColor&&(v.color=e.textColor);var m={mark:c,plain:u,round:d};return _&&(m[_]=_),t("span",a()([{style:v,class:[l([m,r]),{"van-hairline--surround":u}]},Object(s["b"])(i,!0)]),[n.default&&n.default()])}u.props={size:String,mark:Boolean,color:String,plain:Boolean,round:Boolean,textColor:String,type:{type:String,default:"default"}},e["a"]=c(u)},a6f2:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("transition",{attrs:{name:"fade"}},[i("van-popup",{staticStyle:{width:"100%",height:"100%","background-color":"transparent",display:"flex","justify-content":"center","align-items":"center"},attrs:{"lock-scroll":!0,"close-on-click-overlay":!0},model:{value:t.pop_show,callback:function(e){t.pop_show=e},expression:"pop_show"}},[i("div",{staticClass:"container",staticStyle:{background:"transparent"}},[i("div",{staticClass:"turn_close"},[i("van-icon",{attrs:{name:"clear",size:"40px",color:"#f8b62b"},on:{click:t.pop_close}})],1),i("div",{staticClass:"turn_top"},[i("img",{attrs:{src:n("fd6c"),alt:""}})]),i("div",{staticClass:"turn"},[i("div",{staticClass:"turn_bj"},[i("img",{class:{point:t.is_point},attrs:{src:n("6ff8"),alt:""}}),i("div",{staticClass:"turn_pointer"},[i("img",{attrs:{src:n("5a68"),alt:""}}),i("p",{directives:[{name:"show",rawName:"v-show",value:t.start_show,expression:"start_show"}],on:{click:t.get_lev}},[t._v("开始")])])])]),i("div",{staticClass:"turn_bottom"},[i("img",{attrs:{src:n("3260"),alt:""}}),i("div",{staticClass:"turn_bottom_info"},[i("p",{staticClass:"turn_bottom_title"},[t._v("`活动细则`")]),i("div",{staticClass:"turn_bottom_detail"},[t._v("\n                            "+t._s(t.play_readme)+"\n                        ")])])])]),i("van-popup",{staticStyle:{width:"100%",height:"100%","background-color":"rgba(0,0,0,0.4)",display:"flex","justify-content":"center","align-items":"center"},attrs:{"close-on-click-overlay":!0},model:{value:t.reward_show,callback:function(e){t.reward_show=e},expression:"reward_show"}},[i("div",{staticClass:"reward_body"},[i("div",{staticClass:"reward_bj"},[0==t.lv?i("img",{attrs:{src:n("fb4d"),alt:""}}):i("img",{attrs:{src:n("55f6"),alt:""}})]),0==t.lv?i("div",{staticClass:"reward_content"},[i("p",[t._v(t._s(t.win_say))]),i("p",[t._v("下次再接再厉~")])]):i("div",{staticClass:"reward_content"},[i("p",[t._v(t._s(t.win_say))]),i("p",[t._v(t._s(t.win_rewarded)+t._s(t.win_type)+"已存放至您的账户~")])]),i("div",{staticClass:"reward_close_btn",on:{click:t.reward_close}}),i("span",{staticClass:"reward_btn",on:{click:t.pop_close}},[t._v("\n                        关闭页面\n                    ")])])])],1)],1)],1)},a=[],o=n("9523"),s=n.n(o),r=(n("8a58"),n("e41f")),c={name:"turn",data:function(){return{lv:"",win_rewarded:"",win_type:"",win_say:"",play_id:"",play_readme:"",now_type:"",is_point:!1,start_show:!0,reward:{1:["55-80","235-260"],2:["10-35","190-215"],3:["145-170","325-350"],0:["100-125","280-305"]},reward_show:!1,pop_show:!1}},props:{show:{type:Boolean,default:!1},con:{type:String,default:""}},components:s()({},r["a"].name,r["a"]),created:function(){this.now_type=this.con||"",this.get_is_allow(this.now_type)},methods:{reward_close:function(){this.reward_show=!1,this.start_show=!1},pop_close:function(){this.reward_show=!1,this.pop_show=!1,"评价后"==this.now_type&&this.$router.push({path:"/order/orderlist",query:"待评价"})},get_is_allow:function(t){var e=this,n={};n.con=t,"支付后"==this.now_type&&(n.oid=this.$route.query.id),this.$api.getPage.is_turntable(n).then(function(t){200==t.code&&0!=t.result?(e.play_id=t.result.hd_id,e.play_readme=t.result.hd_readme,e.$emit("send_isturn",!0)):0==t.result&&(e.$emit("send_isturn",!1),e.pop_show=!1)})},get_lev:function(){var t=this,e={};e.id=this.play_id,"支付后"==this.now_type&&(e.oid=this.$route.query.id),this.$api.getPage.start_turntable(e).then(function(e){if(200==e.code&&null!=e.result){e.result,t.lv=e.result.lv,t.win_say=e.result.win_say,t.win_type=e.result.balance_type,t.win_rewarded=e.result.money;var n=t.reward[t.lv],i=t.random(0,1),a=n[i].split("-"),o=t.random(parseInt(a[0]),parseInt(a[1]));t.turn(o)}})},turn:function(t){var e=this,n=document.styleSheets[0],i=-1*(1080+t);n.insertRule("    \n                @keyframes turn {\n                0% {\n                    transform: rotate(0deg);\n                }\n                100% {\n                    transform: rotate(".concat(i,"deg);\n                }}")),this.is_point=!0,this.is_point&&setTimeout(function(){e.reward_show=!0,e.is_point=!1},5e3)},random:function(t,e){return parseInt(Math.random()*(e-t+1)+t,10)}},watch:{show:function(t,e){t!=e&&(this.pop_show=t)},con:function(t,e){t!=e&&(this.now_type=t)}}},l=c,u=(n("14e9"),n("2877")),p=Object(u["a"])(l,i,a,!1,null,"0338b670",null);e["a"]=p.exports},b4d0:function(t,e,n){t.exports=n.p+"img/coupon_bj.6d5edce9.png"},bbf6:function(t,e,n){t.exports=n.p+"img/coupon_notice.1f4c1e2f.png"},c078:function(t,e,n){"use strict";var i=n("97685"),a=n.n(i);a.a},ea82:function(t,e,n){},fb4d:function(t,e,n){t.exports=n.p+"img/turn_reward1.7a76344b.png"},fb94:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("van-popup",{attrs:{duration:.5,"lock-scroll":!0,"close-on-click-overlay":!1},model:{value:t.dialogTableVisible,callback:function(e){t.dialogTableVisible=e},expression:"dialogTableVisible"}},[i("div",{staticClass:"coupon_box",on:{close:t.closeDio}},[i("div",{staticClass:"coupon_bj"},[i("img",{attrs:{src:n("bbf6"),alt:""}})]),i("div",{staticClass:"coupon_content"},[i("div",{staticClass:"coupon_title"},[i("div",{staticClass:"coupon_title"},[i("p",[t._v(t._s(t.coupon_type))]),i("p",[t._v(t._s(t.price)+"元福利大放送")])]),i("div",{staticClass:"coupon_body"},t._l(t.da,function(e,a){return i("div",{key:a,staticClass:"coupon_item",on:{click:function(e){return t.$router.push({path:"/shop/shopcoupon"})}}},[i("div",{staticClass:"coupon_item_bj"},[i("img",{attrs:{src:n("b4d0"),alt:""}})]),i("div",{staticClass:"coupon_item_content"},[i("div",{staticClass:"coupon_item_content_left"},[i("p",[i("span",[t._v("￥")]),t._v(t._s(parseFloat(e.money))+"\n                                    ")])]),i("div",{staticClass:"coupon_item_content_right"},[i("p",[t._v(t._s(e.coupon_title)),i("span",[t._v("满"+t._s(e.xfm)+"可用")])]),i("p",[t._v("使用期限:"),i("span",[t._v(t._s(t.$fnc.getTimeFormat(e.end_time))+"止")])]),i("p",[t._v(t._s(e.desc||""))])])])])}),0)])]),i("div",{staticClass:"coupon_go",on:{click:function(e){return t.$router.push({path:"/shop/shopcoupon"})}}}),i("div",{staticClass:"coupon_close",on:{click:t.closeDio}})])])],1)},a=[],o={name:"coupon",props:{show:{type:Boolean,default:!1},da:{type:Array,default:[]},coupon_type:{type:String,default:"优惠卷"}},data:function(){return{title:"优惠卷",price:"",coupon_list:[{money:"",desc:"",xfm:"",end_time:""}],dialogTableVisible:!1}},methods:{closeDio:function(){this.$emit("close_coupon"),this.dialogTableVisible=!1}},watch:{show:function(t,e){t!=e&&(this.dialogTableVisible=t)},da:function(t,e){this.coupon_list=t;var n=0;this.coupon_list.forEach(function(t){n=parseFloat(t.money)+n}),this.price=n}}},s=o,r=(n("c078"),n("2877")),c=Object(r["a"])(s,i,a,!1,null,"21ccf000",null);e["a"]=c.exports},fd6c:function(t,e,n){t.exports=n.p+"img/turntable_top.badee057.png"}}]);