(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f25e7a6"],{"0ee0":function(t,a,e){"use strict";e.r(a);var i,n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"order_refund"},[e("van-nav-bar",{staticClass:"navbar",attrs:{title:"申请退款","left-text":"","left-arrow":"",border:!1},on:{"click-left":t.toBack}}),e("van-card",{directives:[{name:"lazy",rawName:"v-lazy",value:t.info.piclink,expression:"info.piclink"}],staticClass:"card_order_refund",attrs:{num:t.info.number,"lazy-load":"",price:t.$fnc.toFixedZ(t.info.price),desc:t.info.sku_cn,title:t.info.title,thumb:t.info.piclink}}),0==t.info.status?e("div",{staticClass:"box_liy"},[e("van-cell",{attrs:{title:"退款原因","is-link":"",value:t.radio},on:{click:function(a){t.show=!0}}})],1):t._e(),e("div",{staticClass:"box_liy"},[e("p",{staticClass:"box_liy_p"},[t._v("退款金额："),e("span",[t._v("￥"+t._s(t.$fnc.toFixedZ(t.info.money)))])]),0!=t.info.status?e("p",{staticClass:"box_liy_p"},[t._v("退款原因："),e("span",[t._v(t._s(t.info.return_reason))])]):t._e(),0!=t.info.status?e("p",{staticClass:"box_liy_p"},[t._v("退款说明："),e("span",[t._v(t._s(t.info.return_instructions))])]):t._e(),0==t.info.status?e("p",{staticClass:" box_liy_p2 fx"},[e("span",{},[t._v("退款说明：")]),e("van-field",{staticClass:"input_liy",attrs:{placeholder:"选填"},model:{value:t.return_instructions,callback:function(a){t.return_instructions=a},expression:"return_instructions"}})],1):t._e()]),t.$store.state.isSupplier?t._e():e("div",{staticClass:"box_liy"},[t.info.status>1?e("p",{staticClass:"box_liy_p"},[t._v("退货收件人姓名："),e("span",[t._v(t._s(t.info.return_name))])]):t._e(),t.info.status>1?e("p",{staticClass:"box_liy_p"},[t._v("退货收件人电话："),e("span",[t._v(t._s(t.info.return_tel))])]):t._e(),t.info.status>1?e("p",{staticClass:"box_liy_p"},[t._v("退货收件人地址："),e("span",[t._v(t._s(t.info.return_address))])]):t._e()]),t.$store.state.isSupplier?e("div",[e("div",{staticClass:"box_liy"},[e("van-cell-group",{staticClass:"input_group_refund"},[e("div",[e("p",{staticClass:" box_liy_p2 fx box_liy_pp2"},[e("span",{},[t._v("收件人姓名：")]),e("van-field",{staticClass:"input_liy",attrs:{disabled:1!=t.info.status&&2!=t.info.status,placeholder:"请输入收件人姓名"},model:{value:t.info.return_name,callback:function(a){t.$set(t.info,"return_name",a)},expression:"info.return_name"}})],1),e("p",{staticClass:" box_liy_p2 fx box_liy_pp2"},[e("span",{},[t._v("收件人电话：")]),e("van-field",{staticClass:"input_liy",attrs:{disabled:1!=t.info.status&&2!=t.info.status,type:"tel",placeholder:"请输入收件人电话"},model:{value:t.info.return_tel,callback:function(a){t.$set(t.info,"return_tel",a)},expression:"info.return_tel"}})],1),e("p",{staticClass:" box_liy_p2 fx box_liy_pp2"},[e("span",{},[t._v("收件人地址：")]),e("van-field",{staticClass:"input_liy",attrs:{disabled:1!=t.info.status&&2!=t.info.status,placeholder:"请输入收件人地址"},model:{value:t.info.return_address,callback:function(a){t.$set(t.info,"return_address",a)},expression:"info.return_address"}})],1)]),e("p",{staticClass:" box_liy_p2 fx"},[e("span",{},[t._v("备注：")]),e("van-field",{staticClass:"input_liy",attrs:{placeholder:"请输入备注"},model:{value:t.info.admin_remark,callback:function(a){t.$set(t.info,"admin_remark",a)},expression:"info.admin_remark"}})],1),1==t.info.status?e("van-radio-group",{staticClass:"box_liy_p2 fx radio-group",model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[e("span",{},[t._v("申请状态：")]),e("van-radio",{attrs:{name:"0","checked-color":"#07c160"}},[t._v("驳回退货")]),e("van-radio",{attrs:{name:"1","checked-color":"#07c160"}},[t._v("申请退货")]),e("van-radio",{attrs:{name:"2","checked-color":"#07c160"}},[t._v("允许退货")]),e("van-radio",{attrs:{name:"3",disabled:"","checked-color":"#07c160"}},[t._v("已退货待退款")]),e("van-radio",{attrs:{name:"4",disabled:"","checked-color":"#07c160"}},[t._v("退货成功")])],1):t._e(),2==t.info.status||4==t.info.status?e("van-radio-group",{staticClass:"box_liy_p2 fx radio-group",attrs:{disabled:""},model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[e("span",{},[t._v("申请状态：")]),e("van-radio",{attrs:{name:"0","checked-color":"#07c160"}},[t._v("驳回退货")]),e("van-radio",{attrs:{name:"1","checked-color":"#07c160"}},[t._v("申请退货")]),e("van-radio",{attrs:{name:"2","checked-color":"#07c160"}},[t._v("允许退货")]),e("van-radio",{attrs:{name:"3","checked-color":"#07c160"}},[t._v("已退货待退款")]),e("van-radio",{attrs:{name:"4","checked-color":"#07c160"}},[t._v("退货成功")])],1):t._e(),3==t.info.status?e("van-radio-group",{staticClass:"box_liy_p2 fx radio-group",model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[e("span",{},[t._v("申请状态：")]),e("van-radio",{attrs:{name:"0","checked-color":"#07c160"}},[t._v("驳回退货")]),e("van-radio",{attrs:{name:"1",disabled:"","checked-color":"#07c160"}},[t._v("申请退货")]),e("van-radio",{attrs:{name:"2",disabled:"","checked-color":"#07c160"}},[t._v("允许退货")]),e("van-radio",{attrs:{name:"3",disabled:"","checked-color":"#07c160"}},[t._v("已退货待退款")]),e("van-radio",{attrs:{name:"4","checked-color":"#07c160"}},[t._v("退货成功")])],1):t._e()],1)],1)]):e("div",[2==t.info.status||3==t.info.status?e("div",{staticClass:"box_liy"},[e("van-cell-group",{staticClass:"input_group_refund"},[e("p",{staticClass:" box_liy_p2 fx box_liy_pp2"},[e("span",{},[t._v("物流公司：")]),e("van-field",{staticClass:"input_liy",attrs:{disabled:2!=t.info.status,placeholder:"请填写物流公司"},model:{value:t.info.return_mail,callback:function(a){t.$set(t.info,"return_mail",a)},expression:"info.return_mail"}})],1),e("p",{staticClass:" box_liy_p2 fx"},[e("span",{},[t._v("物流单号：")]),e("van-field",{staticClass:"input_liy",attrs:{disabled:2!=t.info.status,placeholder:"请填写物流单号"},model:{value:t.info.return_oid,callback:function(a){t.$set(t.info,"return_oid",a)},expression:"info.return_oid"}})],1)])],1):t._e()]),e("div",{staticClass:"box_img"},[e("p",[t._v("上传凭证")]),t._l(t.pic,function(a,i){return e("div",{key:i,staticClass:"box_img_img"},[e("img",{attrs:{width:"84",height:"84",src:a}}),0==t.info.status?e("span",{on:{click:function(a){return t.closeImg(i)}}},[e("van-icon",{attrs:{name:"cross",size:"18",color:"#fff"}})],1):t._e()])}),t.pic.length<3&&0==t.info.status?e("van-uploader",{attrs:{multiple:"","max-count":3,"after-read":t.afterRead}},[e("div",{staticClass:"up_inp_refund "},[e("van-icon",{staticClass:"fa fa-camera",attrs:{name:"close"}}),e("p",[t._v("上传凭证")]),e("p",[t._v("最多3张")])],1)]):t._e()],2),e("div",{staticClass:"refund_text"},[e("p",[e("van-icon",{attrs:{name:"checked",color:"#fe0036"}}),e("span",[t._v("授权商家填写运单号")])],1)]),t.$store.state.isSupplier?e("div",[e("van-button",{staticClass:"refund_btn",attrs:{type:"danger",size:"large"},on:{click:t.subConfimRefund}},[t._v("确认")])],1):e("div",[0==t.info.status?e("van-button",{staticClass:"refund_btn",attrs:{type:"danger",size:"large"},on:{click:t.subRefund}},[t._v("提交")]):1==t.info.status?e("van-button",{staticClass:"refund_btn",attrs:{type:"danger",size:"large",disabled:""}},[t._v("退货申请中")]):2==t.info.status?e("van-button",{staticClass:"refund_btn",attrs:{type:"danger",size:"large"},on:{click:t.setOrderMail}},[t._v("提交物流信息")]):3==t.info.status?e("van-button",{staticClass:"refund_btn",attrs:{type:"danger",size:"large",disabled:""}},[t._v("审核退款中")]):4==t.info.status?e("van-button",{staticClass:"refund_btn",attrs:{type:"danger",size:"large",disabled:""}},[t._v("退货完成")]):t._e()],1),e("van-popup",{staticClass:"refund_pop",attrs:{position:"bottom"},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[e("div",{staticClass:"refund_pop_head"},[e("p",{staticClass:"refund_pop_head_title"},[t._v("退款原因")]),e("van-radio-group",{staticClass:"refund_pop_head_group",model:{value:t.radio,callback:function(a){t.radio=a},expression:"radio"}},[e("van-cell-group",t._l(t.reason,function(a){return e("van-cell",{key:a,attrs:{title:a,clickable:""},on:{click:function(e){return t.cleckLy(a)}}},[e("van-radio",{attrs:{name:a}})],1)}),1)],1),e("van-button",{attrs:{type:"danger",size:"large"},on:{click:function(a){t.show=!1}}},[t._v("关闭")])],1)])],1)},s=[],r=e("9523"),o=e.n(r),c=(e("4ddd"),e("9f14")),l=(e("a44c"),e("e27c")),u=(e("be7f"),e("565f")),d=(e("9cb7"),e("66fd")),p=e("5118"),f=e("bc3a"),_=e.n(f),v={components:(i={},o()(i,d["a"].name,d["a"]),o()(i,u["a"].name,u["a"]),o()(i,l["a"].name,l["a"]),o()(i,c["a"].name,c["a"]),i),data:function(){return{return_instructions:"",fileList:[],show:!1,radio:"请选择",info:{return_mail:"",return_oid:""},reason:[],pic:[],status:""}},watch:{},created:function(){this.$store.state.isSupplier?this.getSupplierApplication():this.getRefundShops()},methods:{closeImg:function(t){this.pic.splice(t,1)},subConfimRefund:function(){var t=this,a={};a.id=this.$route.query.id||"",a.return_name=this.info.return_name,a.return_tel=this.info.return_tel,a.return_address=this.info.return_address,a.admin_remark=this.info.admin_remark,a.status=this.status,this.$api.getSupplier.addSupplierApplication(a).then(function(a){200==a.code&&(t.$toast.success("提交成功"),Object(p["setTimeout"])(function(){t.getSupplierApplication()},1500))})},getSupplierApplication:function(){var t=this,a={};a.id=this.$route.query.id||"",this.$api.getSupplier.getSupplierApplication(a).then(function(a){if(200==a.code&&(t.info=a.result,t.status=t.info.status,t.reason=a.result.reason||[],t.pic=[],a.result.pic.length>0&&a.result.status>0))for(var e in a.result.pic)t.pic.push(a.result.pic[e].piclink)})},setOrderMail:function(){var t=this;if(""!=this.return_mail&&""!=this.return_oid){var a={};a.id=this.$route.query.id||"",a.return_mail=this.info.return_mail,a.return_oid=this.info.return_oid,this.$api.getOrder.setOrderMail(a).then(function(a){200==a.code&&(t.$toast.success(a.result),Object(p["setTimeout"])(function(){t.getRefundShops()},1500))})}else this.$toast.fail("物流信息不能为空")},subRefund:function(){var t=this;if("请选择"==this.radio)return this.$toast.fail("请选择退货理由"),!1;var a={};a.id=this.$route.query.id||"",a.return_reason=this.radio,a.return_instructions=this.return_instructions,a.pic=this.pic.join("@"),this.$api.getOrder.setOrderRefund(a).then(function(a){200==a.code&&(t.$toast.success(a.result),Object(p["setTimeout"])(function(){t.getRefundShops()},1500))})},cleckLy:function(t){this.radio=t,this.show=!1},getRefundShops:function(){var t=this,a={};a.id=this.$route.query.id||"",this.$api.getOrder.getOrderRefund(a).then(function(a){if(200==a.code&&(t.info=a.result,t.reason=a.result.reason||[],t.pic=[],a.result.pic.length>0&&a.result.status>0))for(var e in a.result.pic)t.pic.push(a.result.pic[e].piclink)})},afterRead:function(t){this.myUpload(t.content)},myUpload:function(t){var a=this,e=new Image;e.src=t,e.onload=function(){var t=document.createElement("canvas"),i=t.getContext("2d"),n=e.width,s=e.height,r=750,o=750,c=n,l=s;(n>r||s>o)&&(n/s>r/o?(c=r,l=Math.round(r*(s/n))):(l=o,c=Math.round(o*(n/s)))),t.width=c,t.height=l,i.clearRect(0,0,c,l),i.drawImage(e,0,0,c,l);var u=t.toDataURL("image/jpeg",.92),d=a.convertBase64UrlToBlob(u),p=new FormData;p.append("file",d,"file_"+Date.parse(new Date)+".jpg");var f={headers:{"Content-Type":"multipart/form-data"}};_.a.post("/api/common/upload/index/",p,f).then(function(t){return 200==t.data.code?(a.pic.push(t.data.result),!0):(a.$toast.fail("上传失败"),!1)})}},convertBase64UrlToBlob:function(t){for(var a=window.atob(t.split(",")[1]),e=new ArrayBuffer(a.length),i=new Uint8Array(e),n=0;n<a.length;n++)i[n]=a.charCodeAt(n);return new Blob([e],{type:"image/png"})}}},b=v,h=(e("58bc"),e("2877")),m=Object(h["a"])(b,n,s,!1,null,"121404c4",null);a["default"]=m.exports},"51e2":function(t,a,e){},"58bc":function(t,a,e){"use strict";var i=e("51e2"),n=e.n(i);n.a},"66fd":function(t,a,e){"use strict";var i=e("2638"),n=e.n(i),s=e("d282"),r=e("a142"),o=e("ba31"),c=e("a3e2"),l=e("44bf"),u=Object(s["a"])("card"),d=u[0],p=u[1];function f(t,a,e,i){var s=a.thumb,u=e.num||Object(r["b"])(a.num),d=e.price||Object(r["b"])(a.price),f=e["origin-price"]||Object(r["b"])(a.originPrice),_=u||d||f;function v(t){Object(o["a"])(i,"click-thumb",t)}function b(){if(e.tag||a.tag)return t("div",{class:p("tag")},[e.tag?e.tag():t(c["a"],{attrs:{mark:!0,type:"danger"}},[a.tag])])}function h(){if(e.thumb||s)return t("a",{attrs:{href:a.thumbLink},class:p("thumb"),on:{click:v}},[e.thumb?e.thumb():t(l["a"],{attrs:{src:s,width:"100%",height:"100%",fit:"contain","lazy-load":a.lazyLoad}}),b()])}function m(){return e.title?e.title():a.title?t("div",{class:p("title")},[a.title]):void 0}function g(){return e.desc?e.desc():a.desc?t("div",{class:[p("desc"),"van-ellipsis"]},[a.desc]):void 0}function y(){if(d)return t("div",{class:p("price")},[e.price?e.price():a.currency+" "+a.price])}function k(){if(f){var i=e["origin-price"];return t("div",{class:p("origin-price")},[i?i():a.currency+" "+a.originPrice])}}function x(){if(u)return t("div",{class:p("num")},[e.num?e.num():"x "+a.num])}function C(){if(e.footer)return t("div",{class:p("footer")},[e.footer()])}return t("div",n()([{class:p()},Object(o["b"])(i,!0)]),[t("div",{class:p("header")},[h(),t("div",{class:p("content",{centered:a.centered})},[m(),g(),e.tags&&e.tags(),_&&t("div",{class:"van-card__bottom"},[y(),k(),x(),e.bottom&&e.bottom()])])]),C()])}f.props={tag:String,desc:String,thumb:String,title:String,centered:Boolean,lazyLoad:Boolean,thumbLink:String,num:[Number,String],price:[Number,String],originPrice:[Number,String],currency:{type:String,default:"¥"}},a["a"]=d(f)},"9b7e":function(t,a,e){},"9cb7":function(t,a,e){"use strict";e("68ef"),e("9b7e"),e("09fe"),e("ea82")},a3e2:function(t,a,e){"use strict";var i=e("2638"),n=e.n(i),s=e("d282"),r=e("ba31"),o=Object(s["a"])("tag"),c=o[0],l=o[1];function u(t,a,e,i){var s,o=a.type,c=a.mark,u=a.plain,d=a.color,p=a.round,f=a.size,_=u?"color":"backgroundColor",v=(s={},s[_]=d,s);a.textColor&&(v.color=a.textColor);var b={mark:c,plain:u,round:p};return f&&(b[f]=f),t("span",n()([{style:v,class:[l([b,o]),{"van-hairline--surround":u}]},Object(r["b"])(i,!0)]),[e.default&&e.default()])}u.props={size:String,mark:Boolean,color:String,plain:Boolean,round:Boolean,textColor:String,type:{type:String,default:"default"}},a["a"]=c(u)},ea82:function(t,a,e){}}]);