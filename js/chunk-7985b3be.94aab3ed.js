(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7985b3be"],{"0500":function(t,a,e){"use strict";e("68ef"),e("09fe"),e("d9d2"),e("afaa")},1288:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"demo"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.panel,expression:"panel"}],staticClass:"container"},[e("div",[e("img",{attrs:{id:"image",src:t.url,alt:"Picture"}})]),e("button",{attrs:{type:"button",id:"button"},on:{click:t.crop}},[t._v("确定")])])])},s=[],c=e("bab4"),n=e.n(c),r={components:{},props:{imgSrc:{type:String,default:""}},data:function(){return{headerImage:"",picValue:"",cropper:"",croppable:!1,panel:!1,url:""}},watch:{imgSrc:function(t){t&&this.change()}},mounted:function(){var t=this,a=document.getElementById("image");this.cropper=new n.a(a,{aspectRatio:1,viewMode:1,background:!0,resizable:!1,dragCrop:!1,zoomable:!0,rotatable:!0,ready:function(){t.croppable=!0}})},methods:{getObjectURL:function(t){var a=null;return void 0!=window.createObjectURL?a=window.createObjectURL(t):void 0!=window.URL?a=window.URL.createObjectURL(t):void 0!=window.webkitURL&&(a=window.webkitURL.createObjectURL(t)),a},change:function(){this.url=this.imgSrc,this.cropper&&this.cropper.replace(this.url),this.panel=!0},crop:function(){var t,a;this.panel=!1,this.croppable&&(t=this.cropper.getCroppedCanvas(),a=this.getRoundedCanvas(t),this.headerImage=a.toDataURL(),this.$emit("sendImg",this.headerImage))},getRoundedCanvas:function(t){var a=document.createElement("canvas"),e=a.getContext("2d"),i=t.width,s=t.height,c=750,n=750,r=i,l=s;return(i>c||s>n)&&(i/s>c/n?(r=c,l=Math.round(c*(s/i))):(l=n,r=Math.round(n*(i/s)))),a.width=r,a.height=l,e.clearRect(0,0,r,l),e.fillStyle="#fff",e.fillRect(0,0,a.width,a.height),e.drawImage(t,0,0,r,l),a}}},l=r,o=(e("32cc"),e("2877")),p=Object(o["a"])(l,i,s,!1,null,null,null);a["a"]=p.exports},"32cc":function(t,a,e){"use strict";var i=e("848a"),s=e.n(i);s.a},"4feb":function(t,a,e){"use strict";var i=e("1988"),s=e("2638"),c=e.n(s),n=e("d282"),r=e("ba31"),l=e("7744"),o=e("1a23"),p=e("2797"),u=Object(n["a"])("switch-cell"),d=u[0],m=u[1];function h(t,a,e,s){return t(l["a"],c()([{attrs:{center:!0,size:a.cellSize,title:a.title,border:a.border},class:m([a.cellSize])},Object(r["b"])(s)]),[t(o["a"],{props:Object(i["a"])({},a),on:Object(i["a"])({},s.listeners)})])}h.props=Object(i["a"])({},p["a"],{title:String,cellSize:String,border:{type:Boolean,default:!0},size:{type:String,default:"24px"}}),a["a"]=d(h)},"762f":function(t,a,e){},"848a":function(t,a,e){},a396:function(t,a,e){"use strict";var i=e("762f"),s=e.n(i);s.a},afaa:function(t,a,e){},c203:function(t,a,e){"use strict";e.r(a);var i,s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"a-z-shop"},[e("van-nav-bar",{staticClass:"navbar",attrs:{title:"发布产品","left-text":"","left-arrow":""},on:{"click-left":function(a){return t.$router.back(-1)}}}),e("div",{staticClass:"a-z-imgs"},[e("div",{staticClass:"box_img"},[t._l(t.pic,function(a,i){return e("div",{key:i,staticClass:"box_img_img"},[e("img",{attrs:{width:"80",height:"80",src:a.piclink}}),e("span",{on:{click:function(e){return t.closeImgPilink(i,a.id)}}},[e("van-icon",{attrs:{name:"cross",size:"18",color:"#fff"}})],1)])}),e("van-uploader",{staticClass:"up_img_add",attrs:{multiple:"","after-read":t.afterRead}},[e("div",{staticClass:"up_inp_refund"},[e("van-icon",{staticClass:"fa fa-camera",attrs:{name:"close",size:"37px",color:"#c2c2c2"}}),e("p",[t._v("添加主图")])],1)])],2)]),e("van-cell-group",{staticClass:"ad_shop mar-top-8"},[e("van-field",{attrs:{type:"textarea",rows:"1",autosize:"",label:"宝贝标题","label-width":"68px",placeholder:"请输入宝贝标题"},model:{value:t.params.title,callback:function(a){t.$set(t.params,"title",a)},expression:"params.title"}})],1),e("van-cell-group",{staticClass:"ad_shop ad_shop2 mar-top-8",attrs:{border:!1}},[e("van-field",{attrs:{rows:"1",autosize:"",label:"产品描述",disabled:"","label-width":"68px",placeholder:"",border:!1},model:{value:t.value,callback:function(a){t.value=a},expression:"value"}}),e("van-field",{attrs:{type:"textarea",rows:"2",autosize:"",placeholder:"描述信息"},model:{value:t.params.sub_title,callback:function(a){t.$set(t.params,"sub_title",a)},expression:"params.sub_title"}})],1),e("van-cell-group",{staticClass:"ad_shop mar-top-8"},[e("van-cell",{attrs:{title:"商品分类",value:t.cateTitle,id:"trigger"}},[e("van-icon",{attrs:{slot:"right-icon",name:"arrow",size:"14px"},slot:"right-icon"})],1),e("van-cell",{staticClass:"cell fx",attrs:{title:"销售价格"}},[e("van-field",{staticClass:"input_cells",attrs:{type:"number",size:"large",placeholder:"请输入销售价格","input-align":"right"},model:{value:t.params.price,callback:function(a){t.$set(t.params,"price",a)},expression:"params.price"}},[e("span",{attrs:{slot:"right-icon"},slot:"right-icon"},[t._v("￥")])])],1),e("van-cell",{staticClass:"cell",attrs:{title:"销售成本"}},[e("van-field",{staticClass:"input_cells",attrs:{placeholder:"请输入销售成本",type:"number","input-align":"right"},model:{value:t.params.cost_price,callback:function(a){t.$set(t.params,"cost_price",a)},expression:"params.cost_price"}},[e("span",{attrs:{slot:"right-icon"},slot:"right-icon"},[t._v("￥")])])],1),e("van-cell",{staticClass:"cell",attrs:{title:"商品库存"}},[e("van-field",{staticClass:"input_cells",attrs:{type:"number",placeholder:"请输入商品库存","input-align":"right"},model:{value:t.params.stock,callback:function(a){t.$set(t.params,"stock",a)},expression:"params.stock"}},[e("span",{attrs:{slot:"right-icon"},slot:"right-icon"},[t._v("件")])])],1),e("van-cell",{staticClass:"cell",attrs:{title:"商品编码"}},[e("van-field",{staticClass:"input_cells",attrs:{placeholder:"请输入商品编码","input-align":"right"},model:{value:t.params.hid,callback:function(a){t.$set(t.params,"hid",a)},expression:"params.hid"}})],1)],1),e("van-cell-group",{staticClass:"ad_shop mar-top-8"},[e("van-switch-cell",{attrs:{"active-value":"1","inactive-value":"0",title:"是否允许红包抵扣"},model:{value:t.params.is_integral,callback:function(a){t.$set(t.params,"is_integral",a)},expression:"params.is_integral"}}),e("van-switch-cell",{attrs:{"active-value":"1","inactive-value":"0",title:"是否免邮"},model:{value:t.params.is_mail,callback:function(a){t.$set(t.params,"is_mail",a)},expression:"params.is_mail"}})],1),e("van-cell-group",{staticClass:"ad_shop mar-top-8"},[e("van-cell",{attrs:{title:"添加详情",border:!1}}),e("div",{staticClass:"a-z-imgs"},[e("div",{},[t._l(t.pic2,function(a,i){return e("div",{key:i,staticClass:"box_img_img_details"},[e("img",{attrs:{width:"100%",src:a}}),e("span",{on:{click:function(a){return t.closeImg(i)}}},[e("van-icon",{attrs:{name:"cross",size:"18",color:"#fff"}})],1)])}),e("van-uploader",{staticClass:"up_img_add",attrs:{multiple:"","after-read":t.afterRead2}},[e("div",{staticClass:"up_inp_refund"},[e("van-icon",{staticClass:"fa fa-camera",attrs:{name:"close",size:"37px",color:"#c2c2c2"}}),e("p",[t._v("添加图片")])],1)])],2)])],1),e("van-button",{staticClass:"pay_order_btn mar-top-8",attrs:{type:"primary",size:"large"},on:{click:t.subShop}},[t._v("提交")]),e("ImgCrop",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],attrs:{imgSrc:t.imgSrc},on:{sendImg:t.getImg}})],1)},c=[],n=e("9523"),r=e.n(n),l=(e("0500"),e("4feb")),o=(e("be7f"),e("565f")),p=(e("bc3a"),e("1288")),u=e("5118"),d=e("d319"),m=e.n(d),h={data:function(){return{pic:[],pic2:[],value:"",checked:!1,showPicker:!1,info:{},imgSrc:"",show:!1,cateTitle:"请选择商品分类",params:{title:"",sub_title:"",cate_id:"",price:"",cost_price:"",hid:"",is_integral:"1",is_mail:"1",weight:"",stock:"999",piclink:"",content:""},columns:[],loading:!0,position:[]}},components:(i={},r()(i,o["a"].name,o["a"]),r()(i,l["a"].name,l["a"]),r()(i,"ImgCrop",p["a"]),i),created:function(){this.showPickerList()},mounted:function(){},methods:{subShop:function(){var t=this,a=this;a.$dialog.confirm({message:"确认提交吗？"}).then(function(){var e=t.params;e.piclink=JSON.stringify(t.pic),e.content=t.pic2.join("@"),e.id?a.$api.getSupplier.saveEditSupplierShop(e).then(function(t){200==t.code&&(a.$toast.success("编辑成功"),Object(u["setTimeout"])(function(){a.$router.back()},1500))}):a.$api.getSupplier.addSupplierShop(e).then(function(t){200==t.code&&(a.$toast.success("添加成功"),Object(u["setTimeout"])(function(){a.$router.back()},1500))})})},showPickerList:function(){var t=this,a=this;this.$api.getShop.getShopCate({}).then(function(e){if(200==e.code){var i=e.result.cate;t.columns=i;var s=new m.a({trigger:"#trigger",title:"选择商品分类",triggerDisplayData:!1,wheels:[{data:i}],keyMap:{id:"id",value:"title",childs:"z"},position:a.position,callback:function(t,e){a.params.cate_id=e[e.length-1].id,a.cateTitle=e[e.length-1].title},transitionEnd:function(t,a){}});t.$route.query.id&&t.getEditProduct(s)}})},getEditProduct:function(t){var a=this,e=this.$route.query.id||"";this.$api.getSupplier.editproductSupplier({id:e}).then(function(e){if(200==e.code){a.params=e.result,a.pic=a.params.piclink;var i=a.params.content,s=i.replace(/<img src="/g,""),c=s.split('"/>');c.pop(),a.pic2=c;var n=[];a.$fnc.getNode(a.columns,a.params.cate_id);for(var r in a.columns)if(a.columns[r].id==a.params.cate_father[0]&&(n[0]=Number(r),a.cateTitle=a.columns[r].title,a.params.cate_father.length>=1))for(var l in a.columns[r].z)if(a.columns[r].z[l].id==a.params.cate_father[1]&&(n[1]=Number(l),a.cateTitle=a.columns[r].z[l].title,a.params.cate_father.length>1&&a.columns[r].z))for(var o in a.columns[r].z[l].z)a.columns[r].z[l].z[o].id==a.params.cate_father[2]&&(n[2]=Number(o),a.cateTitle=a.columns[r].z[l].z[o].title);a.position=n,t.initPosition=n,t.updateWheels(a.columns),t.getValue()}})},getImg:function(t){var a=this;this.$fnc.imgCompress(t,function(t){a.pic.push({id:"0",piclink:t})})},afterRead:function(t){this.show=!0,this.imgSrc=t.content},afterRead2:function(t){var a=this;this.$fnc.imgCompress(t.content,function(t){a.pic2.push(t)})},closeImg:function(t){this.pic2.splice(t,1)},closeImgPilink:function(t,a){var e=this;a>0?this.$api.getSupplier.delImg({id:a}).then(function(a){200==a.code&&e.pic.splice(t,1)}):this.pic.splice(t,1)}}},f=h,g=(e("a396"),e("2877")),v=Object(g["a"])(f,s,c,!1,null,"cf035924",null);a["default"]=v.exports}}]);