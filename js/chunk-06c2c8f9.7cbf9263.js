(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06c2c8f9"],{"1b10":function(t,i,n){"use strict";n.d(i,"a",function(){return e});var e={title:String,loading:Boolean,showToolbar:Boolean,cancelButtonText:String,confirmButtonText:String,visibleItemCount:{type:Number,default:5},itemHeight:{type:Number,default:44}}},"21e2":function(t,i,n){"use strict";n.r(i);var e,s=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"con_team"},[n("van-nav-bar",{staticClass:"navbar",attrs:{title:"战队管理","left-arrow":"",border:!1,"right-text":1==t.info.lord?"保存":""},on:{"click-left":t.onClickLeft,"click-right":t.onClickRight}}),0==t.info.lord?n("div",{staticClass:"adteam con"},[n("div",{staticClass:"liubai"},[t._v("战队详情")]),n("van-cell",{staticClass:"cell",attrs:{title:"战队名称"}},[n("van-field",{staticClass:"input_cell tr",attrs:{disabled:"",placeholder:"请填写您的战队名称"},model:{value:t.info.title,callback:function(i){t.$set(t.info,"title",i)},expression:"info.title"}})],1),n("van-cell",{staticClass:"cell",attrs:{title:"战队头像"}},[n("div",{staticClass:"piclink"},[n("img",{attrs:{src:t.$fnc.getImgUrl(t.info.avatar),alt:""}})])]),n("van-cell",{staticClass:"cell",attrs:{title:"战队口号"}},[n("van-field",{staticClass:"input_cell",attrs:{disabled:"",placeholder:"请输入您的战队口号"},model:{value:t.info.slogan,callback:function(i){t.$set(t.info,"slogan",i)},expression:"info.slogan"}})],1),n("van-row",{staticClass:"team_tabs",attrs:{type:"flex",justify:"center"}},[n("div",{class:{ac_team:0==t.tabs}},[t._v("团队成员")])]),n("div",{staticClass:"con_teamlist"},t._l(t.item,function(i){return n("div",{key:i.id+Math.random(),staticClass:"fx con_team"},[n("img",{staticClass:"man",attrs:{src:t.$fnc.getImgUrl(i.avatar),alt:""}}),n("div",{staticClass:"con_item"},[n("div",{staticClass:"team_info fx_3"},[n("p",{staticClass:"p1"},[t._v(t._s(i.nickname))]),n("div",{staticClass:"p2"},[n("span",{staticClass:"s2"},[t._v(t._s(i.coin_rating_cn))]),n("span",{staticClass:"s3"},[t._v("团队:"+t._s(i.team_num)+"人")])])])])])}),0),n("van-button",{staticClass:"btn_team",attrs:{type:"default"},on:{click:t.outTeam}},[t._v("退出战队")])],1):t._e(),1==t.info.lord?n("div",{staticClass:"adteam con"},[n("div",{staticClass:"liubai"},[t._v("战队设置")]),n("van-cell",{staticClass:"cell",attrs:{title:"战队名称"}},[n("van-field",{staticClass:"input_cell tr",attrs:{placeholder:"请填写您的战队名称"},model:{value:t.info.title,callback:function(i){t.$set(t.info,"title",i)},expression:"info.title"}})],1),n("van-cell",{staticClass:"cell",attrs:{title:"战队头像"}},[t.info.avatar?n("div",{staticClass:"piclink"},[n("van-icon",{staticClass:"close",attrs:{name:"cross"},on:{click:t.closeImg}}),n("img",{attrs:{src:t.$fnc.getImgUrl(t.info.avatar),alt:""}})],1):n("van-uploader",{attrs:{"after-read":t.onRead}})],1),n("van-cell",{staticClass:"cell",attrs:{title:"战队口号"}},[n("van-field",{staticClass:"input_cell",attrs:{placeholder:"请输入您的战队口号"},model:{value:t.info.slogan,callback:function(i){t.$set(t.info,"slogan",i)},expression:"info.slogan"}})],1),n("div",{staticClass:"liubai"},[t._v("加入条件")]),n("van-cell",{staticClass:"cell",attrs:{title:"直推人数"},on:{click:function(i){return t.showPo(1)}}},[n("span",{},[t._v(t._s(1==t.config.team_right_join?t.zt:"不限"))])]),n("van-cell",{staticClass:"cell",attrs:{title:"团队人数",border:!0},on:{click:function(i){return t.showPo(2)}}},[n("span",{},[t._v(t._s(1==t.config.team_right_join?t.dd:"不限"))])]),n("div",{staticClass:"liubai"},[t._v("战队功能")]),1==t.config.team_right_kick?n("van-cell",{staticClass:"cell",attrs:{title:"是否开放加入"}},[n("van-switch",{staticClass:"fx swi",attrs:{"active-color":"#07c160","inactive-color":"#f44"},model:{value:t.is_open,callback:function(i){t.is_open=i},expression:"is_open"}})],1):t._e(),1==t.config.team_right_stoptalk?n("van-cell",{staticClass:"cell",attrs:{title:"是否开放公聊"}},[n("van-switch",{staticClass:"fx swi",attrs:{"active-color":"#07c160","inactive-color":"#f44"},model:{value:t.is_chat,callback:function(i){t.is_chat=i},expression:"is_chat"}})],1):t._e(),n("van-row",{staticClass:"team_tabs",attrs:{type:"flex",justify:"center"}},[n("div",{class:{ac_team:0==t.tabs},on:{click:function(i){t.tabs=0}}},[t._v("团队成员")]),n("div",{class:{ac_team:1==t.tabs},on:{click:function(i){t.tabs=1}}},[t._v("待审核")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:0==t.tabs,expression:"tabs==0"}],staticClass:"con_teamlist"},t._l(t.item,function(i){return n("div",{key:i.id+Math.random(),staticClass:"fx con_team"},[n("img",{staticClass:"man",attrs:{src:t.$fnc.getImgUrl(i.avatar),alt:""}}),n("div",{staticClass:"con_item"},[n("div",{staticClass:"team_info fx_3"},[n("p",{staticClass:"p1"},[t._v(t._s(i.nickname))]),n("div",{staticClass:"p2"},[n("span",{staticClass:"s2"},[t._v(t._s(i.coin_rating_cn))]),n("span",{staticClass:"s3"},[t._v("团队:"+t._s(i.team_num)+"人")])])]),t.info.boss_uid!=i.id?n("div",{staticClass:"team_btn b1",on:{click:function(n){return t.lteout(i.id,i.nickname)}}},[t._v("踢出")]):t._e(),1==t.config.team_right_transfer&&t.info.boss_uid!=i.id?n("div",{staticClass:"team_btn b2",on:{click:function(n){return t.transfer(i.id,i.nickname)}}},[t._v("转让队长")]):t._e()])])}),0),n("div",{directives:[{name:"show",rawName:"v-show",value:1==t.tabs,expression:"tabs==1"}],staticClass:"con_teamlist"},t._l(t.check,function(i){return n("div",{key:i.id+Math.random(),staticClass:"fx con_team"},[n("img",{staticClass:"man",attrs:{src:t.$fnc.getImgUrl(i.avatar),alt:""}}),n("div",{staticClass:"con_item"},[n("div",{staticClass:"team_info fx_3"},[n("p",{staticClass:"p1"},[t._v(t._s(i.nickname))]),n("div",{staticClass:"p2"},[n("span",{staticClass:"s2"},[t._v(t._s(i.coin_rating_cn))]),n("span",{staticClass:"s3"},[t._v("团队:"+t._s(i.team_num)+"人")])])]),n("div",{staticClass:"team_btn b1",on:{click:function(n){return t.refuse(i.id,i.nickname)}}},[t._v("拒绝")]),n("div",{staticClass:"team_btn b2",on:{click:function(n){return t.byjoining(i.id,i.nickname)}}},[t._v("通过")])])])}),0)],1):t._e(),n("van-popup",{attrs:{position:"bottom"},model:{value:t.show1,callback:function(i){t.show1=i},expression:"show1"}},[n("van-picker",{attrs:{columns:t.picker1,"default-index":parseInt(t.info.zt),"show-toolbar":!0},on:{cancel:t.onCancel,confirm:t.onConfirm1}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.show2,callback:function(i){t.show2=i},expression:"show2"}},[n("van-picker",{attrs:{columns:t.picker2,"default-index":parseInt(t.info.dd),"show-toolbar":!0},on:{cancel:t.onCancel,confirm:t.onConfirm2}})],1)],1)},a=[],o=n("9523"),c=n.n(o),l=(n("b000"),n("1a23")),r=(n("5f5f"),n("f253")),u=(n("be7f"),n("565f")),h=n("bc3a"),f=n.n(h),m=n("5118"),d={name:"createteam",components:(e={},c()(e,u["a"].name,u["a"]),c()(e,r["a"].name,r["a"]),c()(e,l["a"].name,l["a"]),e),data:function(){return{avatar:"",checked:"",title:"",slogan:"",is_open:!0,is_chat:!0,info:{avatar:"",title:"",slogan:"",is_open:"1",is_chat:"1",team_num:"0"},check:[],item:[],tabs:"0",config:{},show1:!1,show2:!1,picker1:[],picker2:[],index1:0,index2:0,zt:"",dd:""}},methods:{closeImg:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定删除吗"}).then(function(){t.info.avatar=""})},outTeam:function(){var t=this,i=this;i.$dialog.confirm({title:"操作",message:"确认退出战队吗吗"}).then(function(){var n={};i.$api.getIm.outTeam(n).then(function(n){200==n.code&&(i.$toast.success(n.result),Object(m["setTimeout"])(function(){t.$router.push("/im/team")},3e3))})})},refuse:function(t,i){var n=this;n.$dialog.confirm({title:"操作",message:"确认拒绝"+i+"吗"}).then(function(){var i={};i.other_id=t,i.id=n.info.id,n.$api.getIm.refuseTeam(i).then(function(t){200==t.code&&(n.$toast.success(t.result),Object(m["setTimeout"])(function(){n.getList()},3e3))})})},byjoining:function(t,i){var n=this;n.$dialog.confirm({title:"操作",message:"确认通过"+i+"加入吗"}).then(function(){var i={};i.other_id=t,i.id=n.info.id,n.$api.getIm.byjoining(i).then(function(t){200==t.code&&(n.$toast.success(t.result),Object(m["setTimeout"])(function(){n.getList()},3e3))})})},lteout:function(t,i){var n=this;n.$dialog.confirm({title:"操作",message:"确认踢出"+i+"吗"}).then(function(){var i={};i.other_id=t,i.id=n.info.id,n.$api.getIm.tOutTeam(i).then(function(t){200==t.code&&(n.$toast.success(t.result),Object(m["setTimeout"])(function(){n.getList()},3e3))})})},transfer:function(t,i){var n=this;n.$dialog.confirm({title:"操作",message:"确认把队长转让给"+i+"吗"}).then(function(){var i={};i.other_id=t,i.id=n.info.id,n.$api.getIm.transferTeam(i).then(function(t){200==t.code&&(n.$toast.success(t.result),Object(m["setTimeout"])(function(){n.getList()},3e3))})})},onClickRight:function(){var t=this,i=this;i.$dialog.confirm({title:"操作",message:"确认修改吗"}).then(function(){var n={},e=t.info,s=e.id,a=e.title,o=e.avatar,c=e.slogan,l=e.zt,r=e.dd;n.id=s,n.title=a,n.avatar=o,n.slogan=c,n.zt=l,n.dd=r,n.is_open=1==t.is_open?"1":"0",n.is_chat=1==t.is_chat?"1":"0",i.$api.getIm.saveEaitTeam(n).then(function(n){200==n.code&&(i.$toast.success(n.result),Object(m["setTimeout"])(function(){t.getList()},3e3))})})},showPo:function(t){1==t&&1==this.config.team_right_join?this.show1=!0:2==t&&1==this.config.team_right_join&&(this.show2=!0)},onClickLeft:function(){this.toBack()},onCancel:function(){this.show1=!1,this.show2=!1},onConfirm1:function(t,i){this.zt=t,this.show1=!1,this.info.zt=i},onConfirm2:function(t,i){this.dd=t,this.show2=!1,this.info.dd=i},onRead:function(t){this.cpimgOk(t.content)},getList:function(){var t=this;this.check=[],this.item=[];var i={};i.im=this.$route.query.tid||"",this.$api.getIm.editTeam(i).then(function(i){if(200==i.code){for(var n in t.info=i.result,1==t.info.is_open?t.is_open=!0:t.is_open=!1,1==t.info.is_chat?t.is_chat=!0:t.is_chat=!1,i.result.team)0==i.result.team[n].is_im_team?t.check.push(i.result.team[n]):t.item.push(i.result.team[n]);1==i.result.lord&&(t.config=i.result.config,1==i.result.config.is_zt&&(t.picker1=i.result.config.zt,t.zt=i.result.config.zt[t.info.zt]),1==i.result.config.is_dd&&(t.picker2=i.result.config.dd,t.dd=i.result.config.zt[t.info.dd]))}})},cpimgOk:function(t){this.$toast.loading({mask:!1,message:"上传中...",duration:0});var i=this,n=new Image;n.src=t,n.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d"),s=n.width,a=n.height,o=750,c=750,l=s,r=a;(s>o||a>c)&&(s/a>o/c?(l=o,r=Math.round(o*(a/s))):(r=c,l=Math.round(c*(s/a)))),t.width=l,t.height=r,e.clearRect(0,0,l,r),e.drawImage(n,0,0,l,r);var u=t.toDataURL("image/jpeg",.92),h=i.convertBase64UrlToBlob(u),m=new FormData;m.append("file",h,"file_"+Date.parse(new Date)+".jpg"),m.append("folder","imteam");var d={headers:{"Content-Type":"multipart/form-data"}};f.a.post("/api/common/upload/index/",m,d).then(function(t){200==t.data.code?(i.info.avatar=t.data.result,i.$toast.clear()):i.$toast.fail("图片上传失败")})}},convertBase64UrlToBlob:function(t){for(var i=window.atob(t.split(",")[1]),n=new ArrayBuffer(i.length),e=new Uint8Array(n),s=0;s<i.length;s++)e[s]=i.charCodeAt(s);return new Blob([n],{type:"image/png"})}},created:function(){this.getList()}},v=d,g=(n("2f7a"),n("2877")),p=Object(g["a"])(v,s,a,!1,null,"7aea34bf",null);i["default"]=p.exports},"2f7a":function(t,i,n){"use strict";var e=n("eebe"),s=n.n(e);s.a},"5f5f":function(t,i,n){"use strict";n("68ef"),n("a526")},a526:function(t,i,n){},eebe:function(t,i,n){},f253:function(t,i,n){"use strict";var e=n("1988"),s=n("d282"),a=n("1325"),o=n("1128");function c(t){return Array.isArray(t)?t.map(function(t){return c(t)}):"object"===typeof t?Object(o["a"])({},t):t}var l=n("1b10"),r=n("6aa9"),u=n("543e"),h=n("a142"),f=n("482d"),m=n("3875"),d=200,v=1e3,g=300,p=15,_=Object(s["a"])("picker-column"),b=_[0],C=_[1];function x(t){var i=window.getComputedStyle(t),n=i.transform||i.webkitTransform,e=n.slice(7,n.length-1).split(", ")[5];return Number(e)}function k(t){return Object(h["c"])(t)&&t.disabled}var I=b({mixins:[m["a"]],props:{valueKey:String,className:String,itemHeight:Number,defaultIndex:Number,visibleItemCount:Number,initialOptions:{type:Array,default:function(){return[]}}},data:function(){return{offset:0,duration:0,options:c(this.initialOptions),currentIndex:this.defaultIndex}},created:function(){this.$parent.children&&this.$parent.children.push(this),this.setIndex(this.currentIndex)},destroyed:function(){var t=this.$parent.children;t&&t.splice(t.indexOf(this),1)},watch:{defaultIndex:function(){this.setIndex(this.defaultIndex)}},computed:{count:function(){return this.options.length}},methods:{onTouchStart:function(t){if(this.touchStart(t),this.moving){var i=x(this.$refs.wrapper);this.startOffset=Math.min(0,i)}else this.startOffset=this.offset;this.duration=0,this.moving=!1,this.transitionEndTrigger=null,this.touchStartTime=Date.now(),this.momentumOffset=this.startOffset},onTouchMove:function(t){Object(a["c"])(t),this.moving=!0,this.touchMove(t),this.offset=Object(f["a"])(this.startOffset+this.deltaY,-this.count*this.itemHeight,this.itemHeight);var i=Date.now();i-this.touchStartTime>g&&(this.touchStartTime=i,this.momentumOffset=this.offset)},onTouchEnd:function(){var t=this.offset-this.momentumOffset,i=Date.now()-this.touchStartTime,n=i<g&&Math.abs(t)>p;if(n)this.momentum(t,i);else if(this.offset!==this.startOffset){this.duration=d;var e=this.getIndexByOffset(this.offset);this.setIndex(e,!0)}},onTransitionEnd:function(){this.stopMomentum()},onClickItem:function(t){this.duration=d,this.setIndex(t,!0)},adjustIndex:function(t){t=Object(f["a"])(t,0,this.count);for(var i=t;i<this.count;i++)if(!k(this.options[i]))return i;for(var n=t-1;n>=0;n--)if(!k(this.options[n]))return n},getOptionText:function(t){return Object(h["c"])(t)&&this.valueKey in t?t[this.valueKey]:t},setIndex:function(t,i){var n=this;t=this.adjustIndex(t)||0,this.offset=-t*this.itemHeight;var e=function(){t!==n.currentIndex&&(n.currentIndex=t,i&&n.$emit("change",t))};this.moving?this.transitionEndTrigger=e:e()},setValue:function(t){for(var i=this.options,n=0;n<i.length;n++)if(this.getOptionText(i[n])===t)return this.setIndex(n)},getValue:function(){return this.options[this.currentIndex]},getIndexByOffset:function(t){return Object(f["a"])(Math.round(-t/this.itemHeight),0,this.count-1)},momentum:function(t,i){var n=Math.abs(t/i);t=this.offset+n/.002*(t<0?-1:1);var e=this.getIndexByOffset(t);this.duration=v,this.setIndex(e,!0)},stopMomentum:function(){this.moving=!1,this.duration=0,this.transitionEndTrigger&&(this.transitionEndTrigger(),this.transitionEndTrigger=null)}},render:function(t){var i=this,n=this.itemHeight,e=this.visibleItemCount,s=n*(e-1)/2,a={transform:"translate3d(0, "+(this.offset+s)+"px, 0)",transitionDuration:this.duration+"ms",transitionProperty:this.duration?"all":"none",lineHeight:n+"px"},o={height:n+"px"};return t("div",{class:[C(),this.className],on:{touchstart:this.onTouchStart,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchEnd}},[t("ul",{ref:"wrapper",style:a,class:C("wrapper"),on:{transitionend:this.onTransitionEnd}},[this.options.map(function(n,e){return t("li",{style:o,class:["van-ellipsis",C("item",{disabled:k(n),selected:e===i.currentIndex})],domProps:{innerHTML:i.getOptionText(n)},on:{click:function(){i.onClickItem(e)}}})})])])}}),w=Object(s["a"])("picker"),y=w[0],T=w[1],$=w[2];i["a"]=y({props:Object(e["a"])({},l["a"],{defaultIndex:{type:Number,default:0},columns:{type:Array,default:function(){return[]}},toolbarPosition:{type:String,default:"top"},valueKey:{type:String,default:"text"}}),data:function(){return{children:[]}},computed:{simple:function(){return this.columns.length&&!this.columns[0].values}},watch:{columns:function(){this.setColumns()}},methods:{setColumns:function(){var t=this,i=this.simple?[{values:this.columns}]:this.columns;i.forEach(function(i,n){t.setColumnValues(n,c(i.values))})},emit:function(t){this.simple?this.$emit(t,this.getColumnValue(0),this.getColumnIndex(0)):this.$emit(t,this.getValues(),this.getIndexes())},onChange:function(t){this.simple?this.$emit("change",this,this.getColumnValue(0),this.getColumnIndex(0)):this.$emit("change",this,this.getValues(),t)},getColumn:function(t){return this.children[t]},getColumnValue:function(t){var i=this.getColumn(t);return i&&i.getValue()},setColumnValue:function(t,i){var n=this.getColumn(t);n&&n.setValue(i)},getColumnIndex:function(t){return(this.getColumn(t)||{}).currentIndex},setColumnIndex:function(t,i){var n=this.getColumn(t);n&&n.setIndex(i)},getColumnValues:function(t){return(this.children[t]||{}).options},setColumnValues:function(t,i){var n=this.children[t];n&&JSON.stringify(n.options)!==JSON.stringify(i)&&(n.options=i,n.setIndex(0))},getValues:function(){return this.children.map(function(t){return t.getValue()})},setValues:function(t){var i=this;t.forEach(function(t,n){i.setColumnValue(n,t)})},getIndexes:function(){return this.children.map(function(t){return t.currentIndex})},setIndexes:function(t){var i=this;t.forEach(function(t,n){i.setColumnIndex(n,t)})},onConfirm:function(){this.children.map(function(t){return t.stopMomentum()}),this.emit("confirm")},onCancel:function(){this.emit("cancel")}},render:function(t){var i=this,n=this.itemHeight,e=n*this.visibleItemCount,s=this.simple?[this.columns]:this.columns,o={height:n+"px"},c={height:e+"px"},l={backgroundSize:"100% "+(e-n)/2+"px"},h=this.showToolbar&&t("div",{class:["van-hairline--top-bottom",T("toolbar")]},[this.slots()||[t("div",{attrs:{role:"button",tabindex:"0"},class:T("cancel"),on:{click:this.onCancel}},[this.cancelButtonText||$("cancel")]),this.slots("title")||this.title&&t("div",{class:["van-ellipsis",T("title")]},[this.title]),t("div",{attrs:{role:"button",tabindex:"0"},class:T("confirm"),on:{click:this.onConfirm}},[this.confirmButtonText||$("confirm")])]]);return t("div",{class:T()},["top"===this.toolbarPosition?h:t(),this.loading?t(u["a"],{class:T("loading"),attrs:{color:r["a"]}}):t(),t("div",{class:T("columns"),style:c,on:{touchmove:a["c"]}},[s.map(function(n,e){return t(I,{attrs:{valueKey:i.valueKey,className:n.className,itemHeight:i.itemHeight,defaultIndex:n.defaultIndex||i.defaultIndex,visibleItemCount:i.visibleItemCount,initialOptions:i.simple?n:n.values},on:{change:function(){i.onChange(e)}}})}),t("div",{class:T("mask"),style:l}),t("div",{class:["van-hairline--top-bottom",T("frame")],style:o})]),"bottom"===this.toolbarPosition?h:t()])}})}}]);